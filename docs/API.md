# API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

ç—‡çŠ¶ãƒã‚§ãƒƒã‚«ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹ã®APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§ã§ã™ã€‚

## ãƒ™ãƒ¼ã‚¹ URL

- é–‹ç™ºç’°å¢ƒ: `http://localhost:8000/api/v1`
- æœ¬ç•ªç’°å¢ƒ: `https://your-backend-url.onrender.com/api/v1`

## èªè¨¼

ä¸€éƒ¨ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã¯èªè¨¼ãŒå¿…è¦ã§ã™ã€‚JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’Authorizationãƒ˜ãƒƒãƒ€ãƒ¼ã«å«ã‚ã¦é€ä¿¡ã—ã¦ãã ã•ã„ã€‚

```
Authorization: Bearer <token>
```

## ç—‡çŠ¶é–¢é€£ API

### ç—‡çŠ¶å…¥åŠ›

```http
POST /symptoms/input
```

ç—‡çŠ¶ã®è‡ªç”±å…¥åŠ›ã‚’è§£æã—ã€æ§‹é€ åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã—ã¾ã™ã€‚

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£:**
```json
{
  "text": "é ­ç—›ãŒã²ã©ãã¦ã€åãæ°—ã‚‚ã‚ã‚Šã¾ã™",
  "severity": 4,
  "duration": "1æ—¥",
  "location": "é ­"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "id": "symptom_123",
  "text": "é ­ç—›ãŒã²ã©ãã¦ã€åãæ°—ã‚‚ã‚ã‚Šã¾ã™",
  "severity": 4,
  "duration": "1æ—¥",
  "location": "é ­",
  "category": "é ­éƒ¨ã®ç—‡çŠ¶",
  "keywords": ["é ­ç—›", "åãæ°—"]
}
```

### ç—‡çŠ¶å€™è£œå–å¾—

```http
GET /symptoms/suggestions?category={category}
```

æŒ‡å®šã•ã‚ŒãŸã‚«ãƒ†ã‚´ãƒªã®ç—‡çŠ¶å€™è£œã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `category` (optional): ç—‡çŠ¶ã‚«ãƒ†ã‚´ãƒª

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
[
  {
    "text": "é ­ç—›",
    "category": "é ­éƒ¨",
    "common": true
  }
]
```

### ç—‡çŠ¶ã‚«ãƒ†ã‚´ãƒªå–å¾—

```http
GET /symptoms/categories
```

ç—‡çŠ¶ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "categories": [
    {
      "id": "head",
      "name": "é ­éƒ¨",
      "icon": "ğŸ§ "
    }
  ]
}
```

## è¨ºæ–­é–¢é€£ API

### ç—‡çŠ¶åˆ†æ

```http
POST /diagnosis/analyze
```

å…¥åŠ›ã•ã‚ŒãŸç—‡çŠ¶ã‚’åˆ†æã—ã€æ¨å¥¨ã•ã‚Œã‚‹è¨ºç™‚ç§‘ã‚’è¿”ã—ã¾ã™ã€‚

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£:**
```json
{
  "symptoms": ["é ­ç—›", "åãæ°—"],
  "patient_age": 30,
  "patient_gender": "male",
  "duration": "1æ—¥",
  "severity": 4
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "possible_conditions": ["åé ­ç—›", "ç·Šå¼µå‹é ­ç—›"],
  "recommended_specialties": [
    {
      "id": "neurology",
      "name": "ç¥çµŒå†…ç§‘",
      "description": "è„³ç¥çµŒã«é–¢ã™ã‚‹ç–¾æ‚£ã‚’è¨ºç™‚",
      "urgency": "medium"
    }
  ],
  "urgency_level": "medium",
  "advice": "ç—‡çŠ¶ãŒç¶šãå ´åˆã¯åŒ»ç™‚æ©Ÿé–¢ã‚’å—è¨ºã—ã¦ãã ã•ã„ã€‚",
  "confidence": 0.8
}
```

### è¨ºç™‚ç§‘ä¸€è¦§

```http
GET /diagnosis/specialties
```

ã™ã¹ã¦ã®è¨ºç™‚ç§‘ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
[
  {
    "id": "internal_medicine",
    "name": "å†…ç§‘",
    "description": "ä¸€èˆ¬çš„ãªå†…ç§‘ç–¾æ‚£",
    "urgency": "medium"
  }
]
```

## ç—…é™¢é–¢é€£ API

### ç—…é™¢æ¤œç´¢

```http
POST /hospitals/search
```

æŒ‡å®šã•ã‚ŒãŸæ¡ä»¶ã§ç—…é™¢ã‚’æ¤œç´¢ã—ã¾ã™ã€‚

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£:**
```json
{
  "specialties": ["å†…ç§‘", "å¤–ç§‘"],
  "user_location": {
    "latitude": 35.6762,
    "longitude": 139.6503,
    "address": "æ±äº¬éƒ½æ¸‹è°·åŒº"
  },
  "max_distance": 10.0,
  "emergency_only": false
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
[
  {
    "id": "hospital_1",
    "name": "å¸‚ç«‹ç·åˆç—…é™¢",
    "location": {
      "latitude": 35.6762,
      "longitude": 139.6503,
      "address": "æ±äº¬éƒ½æ¸‹è°·åŒº"
    },
    "phone": "03-1234-5678",
    "specialties": ["å†…ç§‘", "å¤–ç§‘"],
    "hours": [
      {
        "day": "æœˆ",
        "open_time": "09:00",
        "close_time": "17:00",
        "is_closed": false
      }
    ],
    "distance": 1.2,
    "rating": 4.2,
    "website": "https://hospital.example.com",
    "emergency": true
  }
]
```

### å‘¨è¾ºç—…é™¢å–å¾—

```http
GET /hospitals/nearby?latitude={lat}&longitude={lng}&radius={radius}&specialty={specialty}
```

ç¾åœ¨åœ°å‘¨è¾ºã®ç—…é™¢ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `latitude`: ç·¯åº¦ (å¿…é ˆ)
- `longitude`: çµŒåº¦ (å¿…é ˆ)
- `radius`: æ¤œç´¢åŠå¾„(km) (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 5.0)
- `specialty`: è¨ºç™‚ç§‘ (ä»»æ„)

### ç—…é™¢è©³ç´°å–å¾—

```http
GET /hospitals/{hospital_id}
```

æŒ‡å®šã•ã‚ŒãŸç—…é™¢ã®è©³ç´°æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `hospital_id`: ç—…é™¢ID

## ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢é€£ API

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²

```http
POST /users/register
```

æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç™»éŒ²ã—ã¾ã™ã€‚

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£:**
```json
{
  "email": "user@example.com",
  "name": "å±±ç”°å¤ªéƒ",
  "age": 30,
  "gender": "male",
  "phone": "090-1234-5678",
  "notification_preferences": ["hospital_news", "health_info"]
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "id": "user_123",
  "email": "user@example.com",
  "name": "å±±ç”°å¤ªéƒ",
  "age": 30,
  "gender": "male",
  "phone": "090-1234-5678",
  "notification_preferences": ["hospital_news", "health_info"],
  "created_at": "2024-01-01T00:00:00Z",
  "updated_at": "2024-01-01T00:00:00Z"
}
```

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å–å¾—

```http
GET /users/profile
```

**èªè¨¼å¿…é ˆ**

ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’å–å¾—ã—ã¾ã™ã€‚

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°

```http
PUT /users/profile
```

**èªè¨¼å¿…é ˆ**

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã™ã€‚

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£:**
```json
{
  "name": "ç”°ä¸­å¤ªéƒ",
  "age": 31,
  "notification_preferences": ["health_info"]
}
```

### é€šçŸ¥è¨­å®šå–å¾—

```http
GET /users/notification-preferences
```

åˆ©ç”¨å¯èƒ½ãªé€šçŸ¥è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
[
  {
    "type": "hospital_news",
    "enabled": true,
    "description": "ç—…é™¢ã‹ã‚‰ã®ãŠçŸ¥ã‚‰ã›"
  }
]
```

### ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤

```http
DELETE /users/account
```

**èªè¨¼å¿…é ˆ**

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å‰Šé™¤ã—ã¾ã™ã€‚

## ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ»æƒ…å ± API

### å¥åº·ãƒ‹ãƒ¥ãƒ¼ã‚¹å–å¾—

```http
GET /news/health-news?category={category}&limit={limit}
```

å¥åº·æƒ…å ±ãƒ»ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `category`: ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚«ãƒ†ã‚´ãƒª (ä»»æ„)
- `limit`: å–å¾—ä»¶æ•° (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 10)

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
[
  {
    "id": "news_1",
    "title": "ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚¶ã®æµè¡ŒçŠ¶æ³ã«ã¤ã„ã¦",
    "content": "ä»Šã‚·ãƒ¼ã‚ºãƒ³ã®ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚¶ãŒ...",
    "category": "æ„ŸæŸ“ç—‡æƒ…å ±",
    "hospital_id": "hospital_1",
    "hospital_name": "å¸‚ç«‹ç·åˆç—…é™¢",
    "published_at": "2024-01-01T00:00:00Z",
    "priority": "high",
    "tags": ["ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚¶", "äºˆé˜²"],
    "image_url": "https://example.com/image.jpg"
  }
]
```

### å¥åº·ã‚¢ãƒ©ãƒ¼ãƒˆå–å¾—

```http
GET /news/health-alerts?area={area}&severity={severity}
```

å¥åº·ã‚¢ãƒ©ãƒ¼ãƒˆãƒ»ç·Šæ€¥æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `area`: åœ°åŸŸ (ä»»æ„)
- `severity`: é‡è¦åº¦ ("info", "warning", "danger") (ä»»æ„)

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
[
  {
    "id": "alert_1",
    "title": "ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚¶æµè¡Œè­¦å ±",
    "message": "ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚¶ã®æ„ŸæŸ“è€…æ•°ãŒè­¦å ±ãƒ¬ãƒ™ãƒ«ã«é”ã—ã¾ã—ãŸã€‚",
    "severity": "warning",
    "area": "æ±äº¬éƒ½",
    "valid_until": "2024-01-15T00:00:00Z",
    "action_required": true
  }
]
```

### ç—…é™¢ãƒ‹ãƒ¥ãƒ¼ã‚¹å–å¾—

```http
GET /news/hospital-news/{hospital_id}?limit={limit}
```

ç‰¹å®šã®ç—…é™¢ã‹ã‚‰ã®ãŠçŸ¥ã‚‰ã›ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `hospital_id`: ç—…é™¢ID
- `limit`: å–å¾—ä»¶æ•° (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 5)

### ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚«ãƒ†ã‚´ãƒªå–å¾—

```http
GET /news/categories
```

ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ã‚’å–å¾—ã—ã¾ã™ã€‚

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "categories": [
    {
      "id": "infection",
      "name": "æ„ŸæŸ“ç—‡æƒ…å ±",
      "icon": "ğŸ¦ "
    }
  ]
}
```

## ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹

APIã‚¨ãƒ©ãƒ¼ã¯ä»¥ä¸‹ã®å½¢å¼ã§è¿”ã•ã‚Œã¾ã™ï¼š

```json
{
  "detail": "ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"
}
```

### HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰

- `200`: æˆåŠŸ
- `400`: ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼
- `401`: èªè¨¼ã‚¨ãƒ©ãƒ¼
- `404`: ãƒªã‚½ãƒ¼ã‚¹ãŒè¦‹ã¤ã‹ã‚‰ãªã„
- `500`: ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼

## ãƒ¬ãƒ¼ãƒˆåˆ¶é™

APIã«ã¯ä»¥ä¸‹ã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãŒã‚ã‚Šã¾ã™ï¼š

- èªè¨¼ãªã—: 100ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ†
- èªè¨¼ã‚ã‚Š: 1000ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ†

åˆ¶é™ã«é”ã—ãŸå ´åˆã€HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹429ãŒè¿”ã•ã‚Œã¾ã™ã€‚

## API ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°

ç¾åœ¨ã®APIãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ v1 ã§ã™ã€‚URLãƒ‘ã‚¹ã« `/api/v1` ã‚’å«ã‚ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„ã€‚

## OpenAPI/Swagger

ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªAPI ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ä»¥ä¸‹ã®URLã§ç¢ºèªã§ãã¾ã™ï¼š

- é–‹ç™ºç’°å¢ƒ: `http://localhost:8000/docs`
- æœ¬ç•ªç’°å¢ƒ: `https://your-backend-url.onrender.com/docs`